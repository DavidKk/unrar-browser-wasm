(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1073:(e,t,r)=>{Promise.resolve().then(r.bind(r,5051))},5051:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var a=r(924),s=r(6144);let l=null,n=void 0!==globalThis.window;function i(e){var t,r;if(void 0!==e)return e.endsWith("/")?e:e+"/";if(!n)return"/";let a=null==(t=globalThis.document)?void 0:t.querySelector("base");if(null==a?void 0:a.href)try{let e=new URL(a.href,null==(r=globalThis.location)?void 0:r.href).pathname;return e.endsWith("/")?e:e+"/"}catch(e){}return"/"}async function o(e){if(n)return new Promise((t,r)=>{var a;let s=globalThis;if("function"==typeof(null==(a=s.window)?void 0:a.Module))return void t(s.window.Module);let l=i(e),n=s.document;if(!n)return void r(Error("document is not available"));let o=n.createElement("script");o.src=l+"unrar.js",o.onload=()=>{var e;"function"==typeof(null==(e=s.window)?void 0:e.Module)?t(s.window.Module):r(Error("unrar.js loaded but Module is not defined"))},o.onerror=()=>r(Error("Failed to load unrar.js")),n.head.appendChild(o)});{let{createRequire:e}=await r.e(484).then(r.t.bind(r,484,19));return e("file:///home/runner/work/unrar-browser-wasm/unrar-browser-wasm/packages/unrar-wasm/dist/index.js")("../build/unrar.js")}}async function c(e){return l||(l=(async()=>{let t=await o(e),r={};if(n){let t=i(e);r.locateFile=(e,r)=>{if(e.endsWith(".wasm")){let r=t+e;return console.log("[locateFile] WASM 文件路径:",r),r}return r+e}}let a=await t(r);return{Archive:a.Archive,CommandData:a.CommandData,setPassword:a.setPassword,FS:a.FS,HeaderType:{HEAD_FILE:a.FILE_HEAD_VALUE,HEAD_ENDARC:a.ENDARC_HEAD_VALUE},getFileDataPtr:a.getFileDataPtr,getFileDataSize:a.getFileDataSize}})()),l}function d(){return(0,a.jsx)("footer",{className:"bg-white border-t border-gray-200 mt-8",children:(0,a.jsxs)("div",{className:"px-6 py-6 text-center text-gray-500",children:[(0,a.jsxs)("p",{className:"text-xs mb-1",children:["Powered by"," ",(0,a.jsx)("a",{href:"https://www.rarlab.com/",className:"text-blue-600 hover:text-blue-700",children:"UnRAR"})," ","and"," ",(0,a.jsx)("a",{href:"https://webassembly.org/",className:"text-blue-600 hover:text-blue-700",children:"WebAssembly"})]}),(0,a.jsx)("p",{className:"text-xs",children:"All processing happens locally. Your files never leave your device."})]})})}function u(){return(0,a.jsx)("header",{className:"bg-white border-b border-gray-200",children:(0,a.jsx)("div",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"UnRAR Browser"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Extract RAR files in your browser"})]}),(0,a.jsx)("a",{href:"https://github.com/DavidKk/unrar-browser-wasm",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-600 hover:text-gray-900",children:"GitHub"})]})})})}function x(e){let{progress:t,message:r="Loading..."}=e;return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 mb-4",children:[(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-gray-700",children:r}),(0,a.jsxs)("span",{className:"text-gray-500 font-mono",children:[Math.round(t),"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 transition-all duration-300",style:{width:"".concat(t,"%")}})})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Downloading WebAssembly module..."})]})}function m(e){let t="bigint"==typeof e?Number(e):e;if(0===t)return"0 Bytes";let r=Math.floor(Math.log(t)/Math.log(1024));return Math.round(t/Math.pow(1024,r)*100)/100+" "+["Bytes","KB","MB","GB"][r]}function h(e){let{files:t}=e;return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4",children:[(0,a.jsx)("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"Extracted Files"}),(0,a.jsx)("div",{className:"space-y-3",children:t.map((e,t)=>{let r=!!e.data&&!e.isDirectory&&function(e){try{let t=new TextDecoder("utf-8",{fatal:!0}).decode(e);return!/[\x00-\x08\x0B-\x0C\x0E-\x1F]/.test(t)}catch(e){return!1}}(e.data),s=r&&e.data?function(e){try{return new TextDecoder("utf-8").decode(e)}catch(e){return""}}(e.data):"";return(0,a.jsx)("div",{className:"border border-gray-200 rounded overflow-hidden",children:e.isDirectory?(0,a.jsx)("div",{className:"p-3 bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("span",{className:"text-xl mr-2",children:"\uD83D\uDCC1"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"(directory)"})]})]})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"bg-blue-50 p-3 border-b border-blue-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center flex-1 min-w-0",children:[(0,a.jsx)("span",{className:"text-xl mr-2",children:"\uD83D\uDCC4"}),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:m(e.size)})]})]}),e.data&&(0,a.jsx)("button",{onClick:()=>(e=>{if(!e.data)return;let t=new Blob([e.data.slice()]),r=URL.createObjectURL(t),a=document.createElement("a");a.href=r,a.download=e.name,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(r)})(e),className:"ml-3 px-3 py-1.5 bg-blue-600 text-white hover:bg-blue-700 text-xs font-medium rounded transition-colors flex-shrink-0",children:"Download"})]})}),e.data&&(0,a.jsxs)("div",{className:"p-3 bg-white",children:[(0,a.jsx)("div",{className:"text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2",children:"File Content:"}),r?(0,a.jsx)("pre",{className:"bg-gray-50 p-3 rounded border border-gray-200 text-xs font-mono overflow-x-auto whitespace-pre-wrap break-words max-h-64 overflow-y-auto",children:s}):(0,a.jsx)("div",{className:"text-gray-500 italic text-sm",children:"Binary file (cannot display as text)"})]})]})},t)})})]})}function b(e){let{message:t,type:r,onClose:s}=e;return(0,a.jsxs)("div",{className:"p-3 border ".concat({info:"bg-blue-50 border-blue-300 text-blue-900",success:"bg-green-50 border-green-300 text-green-900",error:"bg-red-50 border-red-300 text-red-900"}[r]," flex items-center justify-between mb-4 text-sm"),children:[(0,a.jsx)("span",{className:"flex-1",children:t}),(0,a.jsx)("button",{onClick:s,className:"ml-4 text-current opacity-60 hover:opacity-100",children:"\xd7"})]})}function f(e){let{selectedFile:t,isExtracting:r,moduleLoaded:l,password:n,onPasswordChange:i,onFileSelect:o,onExtract:c,onClear:d}=e,u=(0,s.useRef)(null),[x,h]=(0,s.useState)(!1);return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 mb-4",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h2",{className:"text-base font-semibold text-gray-900 mb-1",children:"Select RAR File"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Files stay in your browser, nothing is uploaded"})]}),t?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"p-3 bg-gray-50 border border-gray-200 mb-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:t.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:m(t.size)})]}),(0,a.jsx)("button",{onClick:d,className:"text-gray-400 hover:text-gray-600 text-lg",children:"\xd7"})]})}),(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-1",children:"Password (optional)"}),(0,a.jsx)("input",{id:"password",type:"text",value:n,onChange:e=>i(e.target.value),placeholder:"Enter password if RAR is encrypted",className:"w-full px-3 py-2 border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",disabled:r}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Leave empty for unencrypted RAR files"})]}),(0,a.jsx)("button",{onClick:c,disabled:!l||r,className:"w-full bg-blue-600 text-white font-medium py-2 px-4 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:r?"Extracting...":"Extract Files"})]}):(0,a.jsxs)("div",{onDrop:e=>{e.preventDefault(),h(!1);let t=e.dataTransfer.files[0];t&&t.name.endsWith(".rar")&&o(t)},onDragOver:e=>{e.preventDefault(),h(!0)},onDragLeave:()=>{h(!1)},className:"border-2 border-dashed p-8 text-center cursor-pointer ".concat(x?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-400 hover:bg-gray-50"),onClick:()=>{var e;return null==(e=u.current)?void 0:e.click()},children:[(0,a.jsx)("input",{ref:u,type:"file",accept:".rar",className:"hidden",onChange:e=>{var t;let r=null==(t=e.target.files)?void 0:t[0];r&&o(r)}}),(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:["Drop RAR file here or ",(0,a.jsx)("span",{className:"text-blue-600",children:"browse"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:".rar files up to 100MB"})]})]})}function g(){let{module:e,loading:t,progress:r,error:l}=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},[t,r]=(0,s.useState)(null),[a,l]=(0,s.useState)(!0),[n,i]=(0,s.useState)(0),[o,d]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let t=!0,a=null;return(async()=>{try{l(!0),i(0);let s=0;a=setInterval(()=>{s<90&&((s+=15*Math.random())>90&&(s=90),t&&i(s))},200);let n=e.basePath||"/";if(e.autoDetectSubPath&&1){let t=window.location.pathname;if(t.includes(e.autoDetectSubPath)){let r=t.match(new RegExp("^(.*?".concat(e.autoDetectSubPath,")")));r&&(n=r[1]+"/")}}let o=await c(n);a&&clearInterval(a),t&&(i(100),r(o),d(null))}catch(e){a&&clearInterval(a),t&&(d(e instanceof Error?e:Error(String(e))),i(0))}finally{t&&l(!1)}})(),()=>{t=!1,a&&clearInterval(a)}},[e.basePath,e.autoDetectSubPath]),{module:t,loading:a,progress:n,error:o}}({autoDetectSubPath:"/nextjs-demo"}),{extractedFiles:n,isExtracting:i,error:o,extract:m,clear:g}=function(e){let[t,r]=(0,s.useState)([]),[a,l]=(0,s.useState)(!1),[n,i]=(0,s.useState)(null),o=(0,s.useCallback)(async(t,r)=>{if(!e)throw Error("UnRAR module not loaded");r?e.setPassword(r):e.setPassword("");let a=e.FS,s="/temp.rar";a.writeFile(s,new Uint8Array(t));let l=new e.CommandData,n=new e.Archive(l);if(!n.openFile(s))throw a.unlink(s),Error("Cannot open RAR file");if(!n.isArchive(!0))throw a.unlink(s),Error("Not a valid RAR file");let i=[];for(;n.readHeader()>0;){let t=n.getHeaderType();if(t===e.HeaderType.HEAD_FILE){let e=n.getFileName(),t=n.getFileSize(),r=n.isDirectory(),a=null;if(!r){let e=n.readFileData(),t=e.size();a=new Uint8Array(t);for(let r=0;r<t;r++)a[r]=e.get(r)}i.push({name:e,size:t,isDirectory:r,data:a})}else if(t===e.HeaderType.HEAD_ENDARC)break;n.seekToNext()}return a.unlink(s),i},[e]),c=(0,s.useCallback)(async(t,s)=>{if(e&&!a){l(!0),r([]),i(null);try{let e=await t.arrayBuffer(),a=await o(e,s);r(a)}catch(e){i(e instanceof Error?e:Error(String(e))),r([])}finally{l(!1)}}},[e,a,o]);return{extractedFiles:t,isExtracting:a,error:n,extract:c,clear:(0,s.useCallback)(()=>{r([]),i(null)},[])}}(e),[y,p]=(0,s.useState)(null),[w,j]=(0,s.useState)(null),[v,N]=(0,s.useState)(""),E=(0,s.useCallback)((e,t)=>{p({message:e,type:t}),("success"===t||"info"===t)&&setTimeout(()=>p(null),5e3)},[]);(0,s.useEffect)(()=>{l?E("Failed to load UnRAR module: ".concat(l.message),"error"):e&&!t&&E("UnRAR module loaded successfully! Ready to extract files.","success")},[t,l,e,E]),(0,s.useEffect)(()=>{o?E("Extraction failed: ".concat(o.message),"error"):n.length>0&&E("Successfully extracted ".concat(n.length," file(s)!"),"success")},[o,n.length,E]);let D=async()=>{w&&(E(v?"Extracting encrypted files...":"Extracting files...","info"),await m(w,v))};return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col bg-gray-50",children:[(0,a.jsx)(u,{}),(0,a.jsxs)("main",{className:"flex-1 max-w-4xl w-full mx-auto px-4 py-6",children:[t&&(0,a.jsx)(x,{progress:r,message:"Loading UnRAR WASM Module"}),y&&(0,a.jsx)(b,{message:y.message,type:y.type,onClose:()=>p(null)}),(0,a.jsx)(f,{selectedFile:w,isExtracting:i,moduleLoaded:!!e,password:v,onPasswordChange:N,onFileSelect:e=>{j(e),g()},onExtract:D,onClear:()=>{j(null),N(""),g()}}),n.length>0&&(0,a.jsx)(h,{files:n})]}),(0,a.jsx)(d,{})]})}}},e=>{e.O(0,[999,970,358],()=>e(e.s=1073)),_N_E=e.O()}]);
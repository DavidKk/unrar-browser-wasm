(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{832:(e,r,t)=>{Promise.resolve().then(t.bind(t,7511))},7511:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>g});var a=t(924),s=t(6144);let l=null,n=void 0!==globalThis.window;function i(e){var r,t;if(void 0!==e)return e.endsWith("/")?e:e+"/";if(!n)return"/";let a=null==(r=globalThis.document)?void 0:r.querySelector("base");if(null==a?void 0:a.href)try{let e=new URL(a.href,null==(t=globalThis.location)?void 0:t.href).pathname;return e.endsWith("/")?e:e+"/"}catch(e){}return"/"}async function o(e){if(n)return new Promise((r,t)=>{var a;let s=globalThis;if("function"==typeof(null==(a=s.window)?void 0:a.Module))return void r(s.window.Module);let l=i(e),n=s.document;if(!n)return void t(Error("document is not available"));let o=n.createElement("script");o.src=l+"unrar.js",o.onload=()=>{var e;"function"==typeof(null==(e=s.window)?void 0:e.Module)?r(s.window.Module):t(Error("unrar.js loaded but Module is not defined"))},o.onerror=()=>t(Error("Failed to load unrar.js")),n.head.appendChild(o)});{let{createRequire:e}=await t.e(484).then(t.t.bind(t,484,19));return e("file:///Users/runner/work/unrar-browser-wasm/unrar-browser-wasm/packages/unrar-wasm/dist/index.js")("../build/unrar.js")}}async function c(e){return l||(l=(async()=>{let r=await o(e),t={};if(n){let r=i(e);t.locateFile=(e,t)=>{if(e.endsWith(".wasm")){let t=r+e;return console.log("[locateFile] WASM 文件路径:",t),t}return t+e}}let a=await r(t);return{Archive:a.Archive,CommandData:a.CommandData,setPassword:a.setPassword,FS:a.FS,HeaderType:{HEAD_FILE:a.FILE_HEAD_VALUE,HEAD_ENDARC:a.ENDARC_HEAD_VALUE},getFileDataPtr:a.getFileDataPtr,getFileDataSize:a.getFileDataSize}})()),l}function d(){return(0,a.jsx)("header",{className:"bg-white border-b border-gray-200",children:(0,a.jsx)("div",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-xl font-semibold text-gray-900",children:"UnRAR Browser (Next.js Demo)"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Extract RAR files in your browser"})]}),(0,a.jsx)("a",{href:"https://github.com/DavidKk/unrar-browser-wasm",target:"_blank",rel:"noopener noreferrer",className:"text-sm text-gray-600 hover:text-gray-900",children:"GitHub"})]})})})}function u(e){let{message:r,type:t,onClose:s}=e;return(0,a.jsxs)("div",{className:"p-3 border ".concat({info:"bg-blue-50 border-blue-300 text-blue-900",success:"bg-green-50 border-green-300 text-green-900",error:"bg-red-50 border-red-300 text-red-900"}[t]," flex items-center justify-between mb-4 text-sm"),children:[(0,a.jsx)("span",{className:"flex-1",children:r}),(0,a.jsx)("button",{onClick:s,className:"ml-4 text-current opacity-60 hover:opacity-100",children:"\xd7"})]})}function x(e){let{progress:r,message:t="Loading..."}=e;return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 mb-4",children:[(0,a.jsxs)("div",{className:"mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm mb-1",children:[(0,a.jsx)("span",{className:"text-gray-700",children:t}),(0,a.jsxs)("span",{className:"text-gray-500 font-mono",children:[Math.round(r),"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-gray-200 h-2",children:(0,a.jsx)("div",{className:"bg-blue-600 h-2 transition-all duration-300",style:{width:"".concat(r,"%")}})})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Downloading WebAssembly module..."})]})}function m(e){let r="bigint"==typeof e?Number(e):e,t=["B","KB","MB","GB"],a=0,s=r;for(;s>=1024&&a<t.length-1;)s/=1024,a++;return"".concat(s.toFixed(2)," ").concat(t[a])}function b(e){let{selectedFile:r,isExtracting:t,moduleLoaded:l,onFileSelect:n,onExtract:i,onClear:o}=e,c=(0,s.useRef)(null),[d,u]=(0,s.useState)(!1);return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4 mb-4",children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h2",{className:"text-base font-semibold text-gray-900 mb-1",children:"Select RAR File"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Files stay in your browser, nothing is uploaded"})]}),r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"p-3 bg-gray-50 border border-gray-200 mb-3",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900",children:r.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:m(r.size)})]}),(0,a.jsx)("button",{onClick:o,className:"text-gray-400 hover:text-gray-600 text-lg",children:"\xd7"})]})}),(0,a.jsx)("button",{onClick:i,disabled:!l||t,className:"w-full bg-blue-600 text-white font-medium py-2 px-4 hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:t?"Extracting...":"Extract Files"})]}):(0,a.jsxs)("div",{onDrop:e=>{e.preventDefault(),u(!1);let r=e.dataTransfer.files[0];r&&r.name.endsWith(".rar")&&n(r)},onDragOver:e=>{e.preventDefault(),u(!0)},onDragLeave:()=>{u(!1)},className:"border-2 border-dashed p-8 text-center cursor-pointer ".concat(d?"border-blue-500 bg-blue-50":"border-gray-300 hover:border-blue-400 hover:bg-gray-50"),onClick:()=>{var e;return null==(e=c.current)?void 0:e.click()},children:[(0,a.jsx)("input",{ref:c,type:"file",accept:".rar",className:"hidden",onChange:e=>{var r;let t=null==(r=e.target.files)?void 0:r[0];t&&n(t)}}),(0,a.jsxs)("p",{className:"text-sm font-medium text-gray-700",children:["Drop RAR file here or ",(0,a.jsx)("span",{className:"text-blue-600",children:"browse"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:".rar files up to 100MB"})]})]})}function h(e){let{files:r}=e;return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 p-4",children:[(0,a.jsx)("h3",{className:"text-base font-semibold text-gray-900 mb-3",children:"Extracted Files"}),(0,a.jsx)("div",{className:"space-y-2",children:r.map((e,r)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-gray-50 border border-gray-200 hover:bg-gray-100",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0 mr-4",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:e.isDirectory?"Directory":m(e.size)})]}),!e.isDirectory&&e.data&&(0,a.jsx)("button",{onClick:()=>(e=>{if(!e.data)return;let r=new Blob([e.data.slice()]),t=URL.createObjectURL(r),a=document.createElement("a");a.href=t,a.download=e.name,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(t)})(e),className:"px-3 py-1 bg-blue-600 text-white hover:bg-blue-700 text-xs font-medium",children:"Download"})]},r))})]})}function f(){return(0,a.jsx)("footer",{className:"bg-white border-t border-gray-200 mt-8",children:(0,a.jsxs)("div",{className:"px-6 py-6 text-center text-gray-500",children:[(0,a.jsxs)("p",{className:"text-xs mb-1",children:["Powered by"," ",(0,a.jsx)("a",{href:"https://www.rarlab.com/",className:"text-blue-600 hover:text-blue-700",children:"UnRAR"})," ","and"," ",(0,a.jsx)("a",{href:"https://webassembly.org/",className:"text-blue-600 hover:text-blue-700",children:"WebAssembly"})]}),(0,a.jsx)("p",{className:"text-xs",children:"All processing happens locally. Your files never leave your device."})]})})}function g(){let{module:e,loading:r,progress:t,error:l}=function(){let[e,r]=(0,s.useState)(null),[t,a]=(0,s.useState)(!0),[l,n]=(0,s.useState)(0),[i,o]=(0,s.useState)(null);return(0,s.useEffect)(()=>{let e=!0,t=null;return(async()=>{try{a(!0),n(0);let s=0;t=setInterval(()=>{s<90&&((s+=15*Math.random())>90&&(s=90),e&&n(s))},200);let l=await c("/");t&&clearInterval(t),e&&(n(100),r(l),o(null))}catch(r){t&&clearInterval(t),e&&(o(r instanceof Error?r:Error(String(r))),n(0))}finally{e&&a(!1)}})(),()=>{e=!1,t&&clearInterval(t)}},[]),{module:e,loading:t,progress:l,error:i}}(),{extractedFiles:n,isExtracting:i,error:o,extract:m,clear:g}=function(e){let[r,t]=(0,s.useState)([]),[a,l]=(0,s.useState)(!1),[n,i]=(0,s.useState)(null),o=(0,s.useCallback)(async r=>{if(!e)throw Error("UnRAR module not loaded");let t=e.FS,a="/temp.rar";t.writeFile(a,new Uint8Array(r));let s=new e.CommandData,l=new e.Archive(s);if(!l.openFile(a))throw t.unlink(a),Error("Cannot open RAR file");if(!l.isArchive(!0))throw t.unlink(a),Error("Not a valid RAR file");let n=[];for(;l.readHeader()>0;){let r=l.getHeaderType();if(r===e.HeaderType.HEAD_FILE){let e=l.getFileName(),r=l.getFileSize(),t=l.isDirectory(),a=null;if(!t){let e=l.readFileData(),r=e.size();a=new Uint8Array(r);for(let t=0;t<r;t++)a[t]=e.get(t)}n.push({name:e,size:r,isDirectory:t,data:a})}else if(r===e.HeaderType.HEAD_ENDARC)break;l.seekToNext()}return t.unlink(a),n},[e]),c=(0,s.useCallback)(async r=>{if(e&&!a){l(!0),t([]),i(null);try{let e=await r.arrayBuffer(),a=await o(e);t(a)}catch(e){i(e instanceof Error?e:Error(String(e))),t([])}finally{l(!1)}}},[e,a,o]);return{extractedFiles:r,isExtracting:a,error:n,extract:c,clear:(0,s.useCallback)(()=>{t([]),i(null)},[])}}(e),[y,p]=(0,s.useState)(null),[w,j]=(0,s.useState)(null),v=(0,s.useCallback)((e,r)=>{p({message:e,type:r}),("success"===r||"info"===r)&&setTimeout(()=>p(null),5e3)},[]);(0,s.useEffect)(()=>{l?v("Failed to load UnRAR module: ".concat(l.message),"error"):e&&!r&&v("UnRAR module loaded successfully! Ready to extract files.","success")},[r,l,e,v]),(0,s.useEffect)(()=>{o?v("Extraction failed: ".concat(o.message),"error"):n.length>0&&v("Successfully extracted ".concat(n.length," file(s)!"),"success")},[o,n.length,v]);let N=async()=>{w&&(v("Extracting files...","info"),await m(w))};return(0,a.jsxs)("div",{className:"min-h-screen flex flex-col bg-gray-50",children:[(0,a.jsx)(d,{}),(0,a.jsxs)("main",{className:"flex-1 max-w-4xl w-full mx-auto px-4 py-6",children:[r&&(0,a.jsx)(x,{progress:t,message:"Loading UnRAR WASM Module"}),y&&(0,a.jsx)(u,{message:y.message,type:y.type,onClose:()=>p(null)}),(0,a.jsx)(b,{selectedFile:w,isExtracting:i,moduleLoaded:!!e,onFileSelect:e=>{j(e),g()},onExtract:N,onClear:()=>{j(null),g()}}),n.length>0&&(0,a.jsx)(h,{files:n})]}),(0,a.jsx)(f,{})]})}}},e=>{e.O(0,[999,970,358],()=>e(e.s=832)),_N_E=e.O()}]);
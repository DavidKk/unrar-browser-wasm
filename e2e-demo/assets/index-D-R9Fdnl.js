(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();const P="modulepreload",T=function(n){return"/unrar-browser-wasm/e2e-demo/"+n},M={},U=function(e,t,o){let r=Promise.resolve();if(t&&t.length>0){let c=function(l){return Promise.all(l.map(f=>Promise.resolve(f).then(u=>({status:"fulfilled",value:u}),u=>({status:"rejected",reason:u}))))};document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),d=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));r=c(t.map(l=>{if(l=T(l),l in M)return;M[l]=!0;const f=l.endsWith(".css"),u=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${u}`))return;const m=document.createElement("link");if(m.rel=f?"stylesheet":P,f||(m.as="script"),m.crossOrigin="",m.href=l,d&&m.setAttribute("nonce",d),document.head.appendChild(m),f)return new Promise((y,p)=>{m.addEventListener("load",y),m.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(c){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=c,window.dispatchEvent(a),!a.defaultPrevented)throw c}return r.then(c=>{for(const a of c||[])a.status==="rejected"&&i(a.reason);return e().catch(i)})};let L=null,E=null;const S=typeof globalThis.window<"u";function C(n){var t,o;if(n!==void 0)return n.endsWith("/")?n:n+"/";if(!S)return"/";const e=(t=globalThis.document)==null?void 0:t.querySelector("base");if(e!=null&&e.href)try{const i=new URL(e.href,(o=globalThis.location)==null?void 0:o.href).pathname;return i.endsWith("/")?i:i+"/"}catch{}return"/"}async function z(n){if(S)return new Promise((e,t)=>{var a;const o=globalThis;if(typeof((a=o.window)==null?void 0:a.Module)=="function"){e(o.window.Module);return}const r=C(n),i=o.document;if(!i){t(new Error("document is not available"));return}const c=i.createElement("script");c.src=r+"unrar.js",c.onload=()=>{var d;typeof((d=o.window)==null?void 0:d.Module)=="function"?e(o.window.Module):t(new Error("unrar.js loaded but Module is not defined"))},c.onerror=()=>t(new Error("Failed to load unrar.js")),i.head.appendChild(c)});{const{createRequire:e}=await U(async()=>{const{createRequire:r}=await Promise.resolve().then(()=>j);return{createRequire:r}},void 0);return e(import.meta.url)("../build/unrar.js")}}async function B(n){return E||(E=(async()=>{const e=await z(n),t={};if(S){const r=C(n);t.locateFile=(i,c)=>{if(i.endsWith(".wasm")){const a=r+i;return console.log("[locateFile] WASM Êñá‰ª∂Ë∑ØÂæÑ:",a),a}return c+i}}const o=await e(t);return L={Archive:o.Archive,CommandData:o.CommandData,setPassword:o.setPassword,FS:o.FS,HeaderType:{HEAD_FILE:o.FILE_HEAD_VALUE,HEAD_ENDARC:o.ENDARC_HEAD_VALUE},getFileDataPtr:o.getFileDataPtr,getFileDataSize:o.getFileDataSize},L})()),E}const h=document.getElementById("moduleStatus"),A=document.getElementById("statusMessage"),F=document.getElementById("consoleOutput"),_=document.getElementById("results"),R=document.getElementById("extractedFiles");let g=null;function s(n,e="info"){const t=new Date().toLocaleTimeString(),o=document.createElement("div"),r={info:"text-blue-400",success:"text-green-400",error:"text-red-400",warn:"text-yellow-400",debug:"text-gray-400"};o.className=r[e],o.textContent=`[${t}] [${e}] ${n}`,F.appendChild(o),F.scrollTop=F.scrollHeight,console.log(`[${e}]`,n)}function b(n,e){A.textContent=n,A.classList.remove("hidden");const t={info:"bg-blue-50 border-blue-200 text-blue-800",success:"bg-green-50 border-green-200 text-green-800",error:"bg-red-50 border-red-200 text-red-800"};A.className=`status ${e} p-3 border rounded mb-4 text-sm ${t[e]}`}function D(n){const e=typeof n=="bigint"?Number(n):n;if(e===0)return"0 Bytes";const t=1024,o=["Bytes","KB","MB","GB"],r=Math.floor(Math.log(e)/Math.log(t));return Math.round(e/Math.pow(t,r)*100)/100+" "+o[r]}async function H(){try{s("Starting to load UnRAR WASM module","info"),g=await B(typeof import.meta<"u"?"/unrar-browser-wasm/e2e-demo/":"/"),s("UnRAR WASM module loaded successfully","success"),h.textContent="UnRAR WASM module loaded successfully ‚úì",h.className="p-3 bg-green-50 border border-green-200 rounded mb-4 text-sm text-green-800",await O()}catch(n){const e=n instanceof Error?n.message:String(n);s("Failed to load UnRAR WASM module: "+e,"error"),h.textContent="Failed to load UnRAR WASM module ‚úó",h.className="p-3 bg-red-50 border border-red-200 rounded mb-4 text-sm text-red-800"}}async function O(){try{s("=== Starting automatic test ===","info"),s("Loading q.rar file...","info");const e="/unrar-browser-wasm/e2e-demo/q.rar".replace(/\/+/g,"/");s(`Fetching from: ${e}`,"debug");const t=await fetch(e);if(!t.ok)throw new Error(`Failed to load file: ${t.status} ${t.statusText}`);const o=await t.arrayBuffer();s(`File loaded successfully, size: ${D(o.byteLength)}`,"info"),await N(o),s("=== Automatic test completed ===","success")}catch(n){const e=n instanceof Error?n.message:String(n);s("Automatic test failed: "+e,"error"),console.error("Automatic test error:",n)}}async function N(n){if(!g){b("UnRAR WASM module not loaded","error");return}try{b("Extracting files...","info"),s("Initializing archive object...","info");const e=g.FS,t="/temp.rar";s("Writing file to virtual file system: "+t,"info"),e.writeFile(t,new Uint8Array(n)),s("File written to virtual file system","info");const o=new g.CommandData;s("CommandData object created successfully","info");const r=new g.Archive(o);if(s("Archive object created successfully","info"),!r.openFile(t))throw e.unlink(t),new Error("Cannot open RAR file");if(s("File opened successfully","info"),!r.isArchive(!0))throw e.unlink(t),new Error("Not a valid RAR file");s("Valid RAR file","info");const a=[];let d;for(;(d=r.readHeader())>0;){const l=r.getHeaderType();if(l===g.HeaderType.HEAD_FILE){const f=r.getFileName(),u=r.getFileSize(),m=r.isDirectory();s(`Found file: ${f}`,"info");let y=null;if(!m){s(`Reading file ${f} content, expected size: ${u}`,"debug");const p=r.readFileData(),x=p.size();if(s(`Read file ${f}, actual size: ${x} bytes`,"info"),x>0){let $="First 10 bytes: ";for(let v=0;v<Math.min(10,x);v++)$+=p.get(v).toString(16).padStart(2,"0")+" ";s($,"debug")}else s("Warning: Read data size is 0!","warn");y=p}a.push({name:f,size:u,isDirectory:m,content:y})}else if(l===g.HeaderType.HEAD_ENDARC){s("Reached end of archive","info");break}r.seekToNext()}e.unlink(t),W(a),b("RAR file extracted successfully!","success"),s("RAR file extracted successfully","info")}catch(e){const t=e instanceof Error?e.message:String(e);throw s("Extraction failed: "+t,"error"),b("Extraction failed: "+t,"error"),console.error("Extraction error:",e),e}}function W(n){if(_.classList.remove("hidden"),R.innerHTML="",n.length===0){R.innerHTML='<p class="text-gray-500">No files found</p>';return}s(`Total ${n.length} file(s)/directory(ies) extracted`,"info");const e=document.createElement("div");e.className="space-y-4",n.forEach((t,o)=>{const r=document.createElement("div");if(r.className="border border-gray-200 rounded-lg overflow-hidden",t.isDirectory)s(`[${o+1}] üìÅ ${t.name} (directory)`,"info"),r.innerHTML=`
        <div class="p-4 bg-gray-50">
          <div class="flex items-center">
            <span class="text-2xl mr-3">üìÅ</span>
            <div>
              <strong class="text-lg">${w(t.name)}</strong>
              <div class="text-xs text-gray-500 mt-1">(directory)</div>
            </div>
          </div>
        </div>
      `;else{const i=D(t.size);if(s(`[${o+1}] üìÑ ${t.name} - ${i}`,"info"),t.content&&t.content.size()>0){const c=t.content.size();s(`  Content size: ${c} bytes`,"info");let a="",d=!0;try{const u=new Uint8Array(Array.from({length:c},(m,y)=>t.content.get(y)));a=new TextDecoder("utf-8").decode(u),s(`  Text content: ${a}`,"info"),d=!/[\x00-\x08\x0B-\x0C\x0E-\x1F]/.test(a)}catch{s("  (Binary file, cannot display as text)","debug"),d=!1}let l="  First 50 bytes (hex): ";const f=Math.min(50,c);for(let u=0;u<f;u++)l+=t.content.get(u).toString(16).padStart(2,"0")+" ";s(l,"debug"),r.innerHTML=`
          <div class="bg-blue-50 p-4 border-b border-blue-100">
            <div class="flex items-center justify-between">
              <div class="flex items-center flex-1">
                <span class="text-2xl mr-3">üìÑ</span>
                <div>
                  <strong class="text-lg">${w(t.name)}</strong>
                  <div class="text-xs text-gray-600 mt-1">${i} ¬∑ ${c} bytes</div>
                </div>
              </div>
              <button onclick="downloadFile('${w(t.name)}', ${o})" class="px-4 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors">
                Download
              </button>
            </div>
          </div>
          <div class="p-4 bg-white">
            <div class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">File Content:</div>
            ${d?`
              <pre class="bg-gray-50 p-4 rounded border border-gray-200 text-sm font-mono overflow-x-auto whitespace-pre-wrap break-words">${w(a)}</pre>
            `:`
              <div class="text-gray-500 italic">Binary file (cannot display as text)</div>
            `}
          </div>
        `}else s("  ‚ö†Ô∏è Warning: Content is empty!","warn"),r.innerHTML=`
          <div class="p-4 bg-red-50 border-red-100">
            <div class="flex items-center">
              <span class="text-2xl mr-3">üìÑ</span>
              <div>
                <strong class="text-lg">${w(t.name)}</strong>
                <div class="text-xs text-red-600 mt-1">‚ö†Ô∏è Empty content</div>
              </div>
            </div>
          </div>
        `}e.appendChild(r)}),R.appendChild(e),window.extractedFiles=n}window.downloadFile=(n,e)=>{const o=window.extractedFiles[e];if(!o||!o.content)return;const r=o.content.size(),i=new Uint8Array(r);for(let l=0;l<r;l++)i[l]=o.content.get(l);const c=new Blob([i]),a=URL.createObjectURL(c),d=document.createElement("a");d.href=a,d.download=n,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(a),s(`File ${n} downloaded successfully`,"info")};function w(n){const e=document.createElement("div");return e.textContent=n,e.innerHTML}document.addEventListener("DOMContentLoaded",()=>{s("Page loaded, starting to load UnRAR WASM module","info"),H()});const j=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));

(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const i of e)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&t(s)}).observe(document,{childList:!0,subtree:!0});function a(e){const i={};return e.integrity&&(i.integrity=e.integrity),e.referrerPolicy&&(i.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?i.credentials="include":e.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function t(e){if(e.ep)return;e.ep=!0;const i=a(e);fetch(e.href,i)}})();const z="modulepreload",U=function(n){return"/unrar-browser-wasm/e2e-demo/"+n},M={},_=function(r,a,t){let e=Promise.resolve();if(a&&a.length>0){let s=function(l){return Promise.all(l.map(d=>Promise.resolve(d).then(m=>({status:"fulfilled",value:m}),m=>({status:"rejected",reason:m}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),u=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));e=s(a.map(l=>{if(l=U(l),l in M)return;M[l]=!0;const d=l.endsWith(".css"),m=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${m}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":z,d||(f.as="script"),f.crossOrigin="",f.href=l,u&&f.setAttribute("nonce",u),document.head.appendChild(f),d)return new Promise((g,p)=>{f.addEventListener("load",g),f.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function i(s){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=s,window.dispatchEvent(c),!c.defaultPrevented)throw s}return e.then(s=>{for(const c of s||[])c.status==="rejected"&&i(c.reason);return r().catch(i)})};let T=null,F=null;const S=typeof globalThis.window<"u";function D(n){var a,t;if(n!==void 0)return n.endsWith("/")?n:n+"/";if(!S)return"/";const r=(a=globalThis.document)==null?void 0:a.querySelector("base");if(r!=null&&r.href)try{const i=new URL(r.href,(t=globalThis.location)==null?void 0:t.href).pathname;return i.endsWith("/")?i:i+"/"}catch{}return"/"}async function H(n){if(S)return new Promise((r,a)=>{var c;const t=globalThis;if(typeof((c=t.window)==null?void 0:c.Module)=="function"){r(t.window.Module);return}const e=D(n),i=t.document;if(!i){a(new Error("document is not available"));return}const s=i.createElement("script");s.src=e+"unrar.js",s.onload=()=>{var u;typeof((u=t.window)==null?void 0:u.Module)=="function"?r(t.window.Module):a(new Error("unrar.js loaded but Module is not defined"))},s.onerror=()=>a(new Error("Failed to load unrar.js")),i.head.appendChild(s)});{const{createRequire:r}=await _(async()=>{const{createRequire:e}=await Promise.resolve().then(()=>q);return{createRequire:e}},void 0);return r(import.meta.url)("../build/unrar.js")}}async function N(n){return F||(F=(async()=>{const r=await H(n),a={};if(S){const e=D(n);a.locateFile=(i,s)=>{if(i.endsWith(".wasm")){const c=e+i;return console.log("[locateFile] WASM Êñá‰ª∂Ë∑ØÂæÑ:",c),c}return s+i}}const t=await r(a);return T={Archive:t.Archive,CommandData:t.CommandData,setPassword:t.setPassword,FS:t.FS,HeaderType:{HEAD_FILE:t.FILE_HEAD_VALUE,HEAD_ENDARC:t.ENDARC_HEAD_VALUE},getFileDataPtr:t.getFileDataPtr,getFileDataSize:t.getFileDataSize},T})()),F}const b=document.getElementById("moduleStatus"),A=document.getElementById("statusMessage"),R=document.getElementById("consoleOutput"),O=document.getElementById("results"),W=document.getElementById("noencResults"),I=document.getElementById("encResults");let y=null;function o(n,r="info"){const a=new Date().toLocaleTimeString(),t=document.createElement("div"),e={info:"text-blue-400",success:"text-green-400",error:"text-red-400",warn:"text-yellow-400",debug:"text-gray-400"};t.className=e[r],t.textContent=`[${a}] [${r}] ${n}`,R.appendChild(t),R.scrollTop=R.scrollHeight,console.log(`[${r}]`,n)}function B(n,r){A.textContent=n,A.classList.remove("hidden");const a={info:"bg-blue-50 border-blue-200 text-blue-800",success:"bg-green-50 border-green-200 text-green-800",error:"bg-red-50 border-red-200 text-red-800"};A.className=`status ${r} p-3 border rounded mb-4 text-sm ${a[r]}`}function $(n){const r=typeof n=="bigint"?Number(n):n;if(r===0)return"0 Bytes";const a=1024,t=["Bytes","KB","MB","GB"],e=Math.floor(Math.log(r)/Math.log(a));return Math.round(r/Math.pow(a,e)*100)/100+" "+t[e]}async function j(){try{o("Starting to load UnRAR WASM module","info"),y=await N(typeof import.meta<"u"?"/unrar-browser-wasm/e2e-demo/":"/"),o("UnRAR WASM module loaded successfully","success"),b.textContent="UnRAR WASM module loaded successfully ‚úì",b.className="p-3 bg-green-50 border border-green-200 rounded mb-4 text-sm text-green-800",await k()}catch(n){const r=n instanceof Error?n.message:String(n);o("Failed to load UnRAR WASM module: "+r,"error"),b.textContent="Failed to load UnRAR WASM module ‚úó",b.className="p-3 bg-red-50 border border-red-200 rounded mb-4 text-sm text-red-800"}}async function k(){try{o("=== Starting automatic dual test ===","info");const n="/unrar-browser-wasm/e2e-demo/";o("--- Test 1: Loading noencryption.rar (no password) ---","info");const r=`${n}noencryption.rar`.replace(/\/+/g,"/");o(`Fetching from: ${r}`,"debug");const a=await fetch(r);if(!a.ok)throw new Error(`Failed to load noencryption.rar: ${a.status}`);const t=await a.arrayBuffer();o(`noencryption.rar loaded, size: ${$(t.byteLength)}`,"info");const e=await P(t,"","noencryption.rar");C(e,W,"No Encryption"),o("‚úì Test 1 completed","success"),o("--- Test 2: Loading encryption.rar (with password) ---","info");const i=`${n}encryption.rar`.replace(/\/+/g,"/");o(`Fetching from: ${i}`,"debug");const s=await fetch(i);if(!s.ok)throw new Error(`Failed to load encryption.rar: ${s.status}`);const c=await s.arrayBuffer();o(`encryption.rar loaded, size: ${$(c.byteLength)}`,"info");const u=await P(c,"123","encryption.rar");C(u,I,"Encrypted"),o("‚úì Test 2 completed","success"),O.classList.remove("hidden"),B("All tests completed successfully!","success"),o("=== All automatic tests completed ===","success")}catch(n){const r=n instanceof Error?n.message:String(n);o("Automatic test failed: "+r,"error"),B("Test failed: "+r,"error"),console.error("Automatic test error:",n)}}async function P(n,r="",a="archive.rar"){if(!y)throw new Error("UnRAR WASM module not loaded");try{o(`Extracting ${a}...`,"info"),o("Initializing archive object...","info"),r?(o("Setting password...","info"),y.setPassword(r),o("Password set successfully","success")):(o("No password provided, clearing any previous password","info"),y.setPassword(""));const t=y.FS,e="/temp.rar";o("Writing file to virtual file system: "+e,"info"),t.writeFile(e,new Uint8Array(n)),o("File written to virtual file system","info");const i=new y.CommandData;o("CommandData object created successfully","info");const s=new y.Archive(i);if(o("Archive object created successfully","info"),!s.openFile(e))throw t.unlink(e),new Error("Cannot open RAR file");if(o("File opened successfully","info"),!s.isArchive(!0))throw t.unlink(e),new Error("Not a valid RAR file");o("Valid RAR file","info");const l=[];let d;for(;(d=s.readHeader())>0;){const m=s.getHeaderType();if(m===y.HeaderType.HEAD_FILE){const f=s.getFileName(),g=s.getFileSize(),p=s.isDirectory();o(`Found file: ${f}`,"info");let h=null;if(!p){o(`Reading file ${f} content, expected size: ${g}`,"debug");const v=s.readFileData(),x=v.size();if(o(`Read file ${f}, actual size: ${x} bytes`,"info"),x>0){let L="First 10 bytes: ";for(let E=0;E<Math.min(10,x);E++)L+=v.get(E).toString(16).padStart(2,"0")+" ";o(L,"debug")}else o("Warning: Read data size is 0!","warn");h=v}l.push({name:f,size:g,isDirectory:p,content:h})}else if(m===y.HeaderType.HEAD_ENDARC){o("Reached end of archive","info");break}s.seekToNext()}return t.unlink(e),o(`Extracted ${l.length} file(s)/directory(ies)`,"info"),l}catch(t){const e=t instanceof Error?t.message:String(t);throw o("Extraction failed: "+e,"error"),console.error("Extraction error:",t),t}}function C(n,r,a){if(r.innerHTML="",n.length===0){r.innerHTML='<p class="text-gray-500">No files found</p>';return}o(`[${a}] Total ${n.length} file(s)/directory(ies) extracted`,"info");const t=document.createElement("div");t.className="space-y-4",n.forEach((e,i)=>{const s=document.createElement("div");if(s.className="border border-gray-200 rounded-lg overflow-hidden",e.isDirectory)o(`[${i+1}] üìÅ ${e.name} (directory)`,"info"),s.innerHTML=`
        <div class="p-4 bg-gray-50">
          <div class="flex items-center">
            <span class="text-2xl mr-3">üìÅ</span>
            <div>
              <strong class="text-lg">${w(e.name)}</strong>
              <div class="text-xs text-gray-500 mt-1">(directory)</div>
            </div>
          </div>
        </div>
      `;else{const c=$(e.size);if(o(`[${i+1}] üìÑ ${e.name} - ${c}`,"info"),e.content&&e.content.size()>0){const u=e.content.size();o(`  Content size: ${u} bytes`,"info");let l="",d=!0;try{const g=new Uint8Array(Array.from({length:u},(p,h)=>e.content.get(h)));l=new TextDecoder("utf-8").decode(g),o(`  Text content: ${l}`,"info"),d=!/[\x00-\x08\x0B-\x0C\x0E-\x1F]/.test(l)}catch{o("  (Binary file, cannot display as text)","debug"),d=!1}let m="  First 50 bytes (hex): ";const f=Math.min(50,u);for(let g=0;g<f;g++)m+=e.content.get(g).toString(16).padStart(2,"0")+" ";o(m,"debug"),s.innerHTML=`
          <div class="bg-blue-50 p-4 border-b border-blue-100">
            <div class="flex items-center justify-between">
              <div class="flex items-center flex-1">
                <span class="text-2xl mr-3">üìÑ</span>
                <div>
                  <strong class="text-lg">${w(e.name)}</strong>
                  <div class="text-xs text-gray-600 mt-1">${c} ¬∑ ${u} bytes</div>
                </div>
              </div>
              <button onclick="downloadFile('${w(e.name)}', ${i})" class="px-4 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors">
                Download
              </button>
            </div>
          </div>
          <div class="p-4 bg-white">
            <div class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">File Content:</div>
            ${d?`
              <pre class="bg-gray-50 p-4 rounded border border-gray-200 text-sm font-mono overflow-x-auto whitespace-pre-wrap break-words">${w(l)}</pre>
            `:`
              <div class="text-gray-500 italic">Binary file (cannot display as text)</div>
            `}
          </div>
        `}else o("  ‚ö†Ô∏è Warning: Content is empty!","warn"),s.innerHTML=`
          <div class="p-4 bg-red-50 border-red-100">
            <div class="flex items-center">
              <span class="text-2xl mr-3">üìÑ</span>
              <div>
                <strong class="text-lg">${w(e.name)}</strong>
                <div class="text-xs text-red-600 mt-1">‚ö†Ô∏è Empty content</div>
              </div>
            </div>
          </div>
        `}t.appendChild(s)}),r.appendChild(t),window.extractedFilesByTest||(window.extractedFilesByTest={}),window.extractedFilesByTest[a]=n}window.downloadFile=(n,r,a)=>{let t;if(a&&window.extractedFilesByTest&&(t=window.extractedFilesByTest[a]),t||(t=window.extractedFiles),!t||!t[r])return;const e=t[r];if(!e||!e.content)return;const i=e.content.size(),s=new Uint8Array(i);for(let d=0;d<i;d++)s[d]=e.content.get(d);const c=new Blob([s]),u=URL.createObjectURL(c),l=document.createElement("a");l.href=u,l.download=n,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(u),o(`File ${n} downloaded successfully`,"info")};function w(n){const r=document.createElement("div");return r.textContent=n,r.innerHTML}document.addEventListener("DOMContentLoaded",()=>{o("Page loaded, starting to load UnRAR WASM module","info"),j()});const q=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"}));
